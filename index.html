<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أذكار الصباح والمساء والنوم</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            transition: all 0.3s ease;
            min-height: 100vh;
        }

        .morning {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }

        .evening {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
        }

        .sleep {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .reminder-section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .reminder-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }

        .reminder-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            min-width: 200px;
        }

        .reminder-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .reminder-btn.active {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
        }

        .reminder-settings {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }

        .time-input {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .time-input label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .time-input input {
            padding: 8px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: inherit;
            text-align: center;
            font-size: 0.9rem;
        }

        .reminder-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }

        .option-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
            background: rgba(255,255,255,0.1);
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-checkbox:hover {
            background: rgba(255,255,255,0.2);
        }

        .option-checkbox input {
            margin: 0;
        }

        .reminder-status {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 10px;
            min-height: 20px;
            text-align: center;
        }

        .reminder-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            z-index: 1000;
            text-align: center;
            display: none;
            animation: pulse 1s infinite;
            max-width: 90vw;
        }

        .reminder-alert.show {
            display: block;
        }

        .reminder-alert h2 {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .reminder-alert p {
            font-size: 1.2rem;
            margin-bottom: 20px;
        }

        .reminder-alert button {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            margin: 0 10px;
            transition: all 0.3s ease;
        }

        .reminder-alert button:hover {
            background: white;
            color: #ff6b6b;
        }

        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.05); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 999;
            display: none;
        }

        .overlay.show {
            display: block;
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 12px 25px;
            border: 2px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.1);
            color: inherit;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .nav-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.6);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .progress-container {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .dhikr-container {
            display: none;
        }

        .dhikr-container.active {
            display: block;
        }

        .dhikr-item {
            background: rgba(255,255,255,0.1);
            margin: 20px 0;
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .dhikr-item.completed {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.2);
        }

        .dhikr-text {
            font-size: 1.2rem;
            line-height: 1.8;
            margin-bottom: 15px;
            text-align: center;
        }

        .dhikr-source {
            font-size: 0.9rem;
            opacity: 0.8;
            text-align: center;
            margin-bottom: 20px;
            font-style: italic;
        }

        .dhikr-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .count-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: default;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            min-width: 80px;
        }

        .action-btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            min-width: 100px;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
        }

        .reset-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            min-width: 100px;
        }

        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
        }

        .reset-all-btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            margin: 30px auto;
            display: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .reset-all-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .footer-info {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .footer-info h3 {
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .footer-info p {
            font-size: 0.9rem;
            opacity: 0.8;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .dhikr-controls {
                flex-direction: column;
                gap: 10px;
            }
            
            .nav-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .nav-btn {
                width: 200px;
            }

            .reminder-settings {
                flex-direction: column;
                align-items: center;
            }

            .reminder-options {
                flex-direction: column;
                align-items: center;
            }
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
    </style>
</head>
<body class="morning">
    <div class="overlay" id="overlay"></div>
    <div class="reminder-alert" id="reminderAlert">
        <h2 id="alertTitle">🌅 وقت أذكار الصباح</h2>
        <p id="alertMessage">حان وقت أذكار الصباح. بارك الله في يومك!</p>
        <button onclick="dismissAlert()">تم</button>
        <button onclick="snoozeAlert()">تأجيل 5 دقائق</button>
    </div>

    <div class="container">
        <div class="header">
            <h1 id="page-title">أذكار الصباح</h1>
            
            <div class="reminder-section">
                <div class="reminder-controls">
                    <button class="reminder-btn" id="reminder-btn" onclick="toggleReminder()">🔔 تفعيل التذكير</button>
                    
                    <div class="reminder-settings" id="reminder-settings" style="display: none;">
                        <div class="time-input">
                            <label>وقت أذكار الصباح</label>
                            <input type="time" id="morning-time" value="06:00">
                        </div>
                        <div class="time-input">
                            <label>وقت أذكار المساء</label>
                            <input type="time" id="evening-time" value="18:00">
                        </div>
                    </div>

                    <div class="reminder-options" id="reminder-options" style="display: none;">
                        <label class="option-checkbox">
                            <input type="checkbox" id="sound-enabled" checked>
                            <span>🔊 صوت</span>
                        </label>
                        <label class="option-checkbox">
                            <input type="checkbox" id="vibration-enabled" checked>
                            <span>📳 اهتزاز</span>
                        </label>
                        <label class="option-checkbox">
                            <input type="checkbox" id="visual-enabled" checked>
                            <span>👁️ تنبيه مرئي</span>
                        </label>
                    </div>
                </div>
                
                <div class="reminder-status" id="reminder-status">مصمم خصيصاً للعمل على جميع الأجهزة</div>
            </div>

            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showDhikr('morning')">أذكار الصباح</button>
                <button class="nav-btn" onclick="showDhikr('evening')">أذكار المساء</button>
                <button class="nav-btn" onclick="showDhikr('sleep')">أذكار النوم</button>
            </div>
        </div>

        <div class="progress-container">
            <div id="progress-text">0/26 (0%)</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>

        <div id="morning-dhikr" class="dhikr-container active">
            <!-- سيتم ملء المحتوى بواسطة JavaScript -->
        </div>
        <div id="evening-dhikr" class="dhikr-container">
            <!-- سيتم ملء المحتوى بواسطة JavaScript -->
        </div>
        <div id="sleep-dhikr" class="dhikr-container">
            <!-- سيتم ملء المحتوى بواسطة JavaScript -->
        </div>

        <button class="reset-all-btn" id="reset-all-btn" onclick="resetAllDhikr()">🔄 إعادة الأذكار</button>

        <div class="footer-info">
            <h3>🤲 بركة الأذكار</h3>
            <p>اللهم اجعل هذا العمل خالصاً لوجهك الكريم، وانفع به المسلمين في كل مكان</p>
        </div>
    </div>

    <script>
        // بيانات الأذكار الكاملة
        const dhikrData = {
            morning: [
                {
                    text: "أَعُوذُ بِاللهِ مِنْ الشَّيْطَانِ الرَّجِيمِ\nاللّهُ لاَ إِلَـهَ إِلاَّ هُوَ الْحَيُّ الْقَيُّومُ لاَ تَأْخُذُهُ سِنَةٌ وَلاَ نَوْمٌ لَّهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الأَرْضِ مَن ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلاَّ بِإِذْنِهِ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ وَلاَ يُحِيطُونَ بِشَيْءٍ مِّنْ عِلْمِهِ إِلاَّ بِمَا شَاء وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالأَرْضَ وَلاَ يَؤُودُهُ حِفْظُهُمَا وَهُوَ الْعَلِيُّ الْعَظِيمُ",
                    source: "آية الكرسي - البقرة 255. من قالها حين يصبح أجير من الجن حتى يمسى",
                    count: 1
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ هُوَ ٱللَّهُ أَحَدٌ، ٱللَّهُ ٱلصَّمَدُ، لَمْ يَلِدْ وَلَمْ يُولَدْ، وَلَمْ يَكُن لَّهُۥ كُفُوًا أَحَدٌۢ",
                    source: "من قالها حين يصبح وحين يمسى كفته من كل شىء",
                    count: 3
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ أَعُوذُ بِرَبِّ ٱلْفَلَقِ، مِن شَرِّ مَا خَلَقَ، وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ، وَمِن شَرِّ ٱلنَّفَّٰثَٰتِ فِى ٱلْعُقَدِ، وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ",
                    source: "سورة الفلق",
                    count: 3
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ أَعُوذُ بِرَبِّ ٱلنَّاسِ، مَلِكِ ٱلنَّاسِ، إِلَٰهِ ٱلنَّاسِ، مِن شَرِّ ٱلْوَسْوَاسِ ٱلْخَنَّاسِ، ٱلَّذِى يُوَسْوِسُ فِى صُدُورِ ٱلنَّاسِ، مِنَ ٱلْجِنَّةِ وَٱلنَّاسِ",
                    source: "سورة الناس",
                    count: 3
                },
                {
                    text: "اصبحنا واصبح المُـلْكُ لله وَالحَمدُ لله ، لا إلهَ إلاّ اللّهُ وَحدَهُ لا شَريكَ لهُ، لهُ المُـلكُ ولهُ الحَمْـد، وهُوَ على كلّ شَيءٍ قدير ، رَبِّ أسْـأَلُـكَ خَـيرَ ما في هـذا اليوم وَخَـيرَ ما بَعْـدَه ، وَأَعـوذُ بِكَ مِنْ شَـرِّ ما في هذا اليوم وَشَرِّ ما بَعْـدَه، رَبِّ أَعـوذُبِكَ مِنَ الْكَسَـلِ وَسـوءِ الْكِـبَر ، رَبِّ أَعـوذُ بِكَ مِنْ عَـذابٍ في النّـارِ وَعَـذابٍ في القَـبْر",
                    source: "رواه مسلم",
                    count: 1
                },
                {
                    text: "اللّهـمَّ أَنْتَ رَبِّـي لا إلهَ إلاّ أَنْتَ ، خَلَقْتَنـي وَأَنا عَبْـدُك ، وَأَنا عَلـى عَهْـدِكَ وَوَعْـدِكَ ما اسْتَـطَعْـت ، أَعـوذُبِكَ مِنْ شَـرِّ ما صَنَـعْت ، أَبـوءُ لَـكَ بِنِعْـمَتِـكَ عَلَـيَّ وَأَبـوءُ بِذَنْـبي فَاغْفـِرْ لي فَإِنَّـهُ لا يَغْـفِرُ الذُّنـوبَ إِلاّ أَنْتَ",
                    source: "من قالها موقنا بها حين يمسى ومات من ليلته دخل الجنة وكذلك حين يصبح",
                    count: 1
                },
                {
                    text: "رَضيـتُ بِاللهِ رَبَّـاً وَبِالإسْلامِ ديـناً وَبِمُحَـمَّدٍ صلى الله عليه وسلم نَبِيّـاً",
                    source: "من قالها حين يصبح وحين يمسى كان حقا على الله أن يرضيه يوم القيامة",
                    count: 3
                },
                {
                    text: "اللّهُـمَّ إِنِّـي اصبحت أُشْـهِدُك ، وَأُشْـهِدُ حَمَلَـةَ عَـرْشِـك ، وَمَلَائِكَتَكَ ، وَجَمـيعَ خَلْـقِك ، أَنَّـكَ أَنْـتَ اللهُ لا إلهَ إلاّ أَنْـتَ وَحْـدَكَ لا شَريكَ لَـك ، وَأَنَّ ُ مُحَمّـداً عَبْـدُكَ وَرَسـولُـك",
                    source: "من قالها أعتقه الله من النار",
                    count: 4
                },
                {
                    text: "اللّهُـمَّ ما اصبح بي مِـنْ نِعْـمَةٍ أَو بِأَحَـدٍ مِـنْ خَلْـقِك ، فَمِـنْكَ وَحْـدَكَ لا شريكَ لَـك ، فَلَـكَ الْحَمْـدُ وَلَـكَ الشُّكْـر",
                    source: "من قالها حين يصبح أدى شكر يومه",
                    count: 1
                },
                {
                    text: "حَسْبِـيَ اللّهُ لا إلهَ إلاّ هُوَ عَلَـيهِ تَوَكَّـلتُ وَهُوَ رَبُّ العَرْشِ العَظـيم",
                    source: "من قالها كفاه الله ما أهمه من أمر الدنيا والآخرة",
                    count: 7
                },
                {
                    text: "بِسـمِ اللهِ الذي لا يَضُـرُّ مَعَ اسمِـهِ شَيءٌ في الأرْضِ وَلا في السّمـاءِ وَهـوَ السّمـيعُ العَلـيم",
                    source: "لم يضره من الله شيء",
                    count: 3
                },
                {
                    text: "اللّهُـمَّ بِكَ اصبحنا وَبِكَ امسينا ، وَبِكَ نَحْـيا وَبِكَ نَمُـوتُ وَإِلَـيْكَ النشور",
                    source: "رواه الترمذي",
                    count: 1
                },
                {
                    text: "اصبحنا عَلَى فِطْرَةِ الإسْلاَمِ، وَعَلَى كَلِمَةِ الإِخْلاَصِ، وَعَلَى دِينِ نَبِيِّنَا مُحَمَّدٍ صَلَّى اللهُ عَلَيْهِ وَسَلَّمَ، وَعَلَى مِلَّةِ أَبِينَا إبْرَاهِيمَ حَنِيفاً مُسْلِماً وَمَا كَانَ مِنَ المُشْرِكِينَ",
                    source: "رواه أحمد",
                    count: 1
                },
                {
                    text: "سُبْحـانَ اللهِ وَبِحَمْـدِهِ عَدَدَ خَلْـقِه ، وَرِضـا نَفْسِـه ، وَزِنَـةَ عَـرْشِـه ، وَمِـدادَ كَلِمـاتِـه",
                    source: "رواه مسلم",
                    count: 3
                },
                {
                    text: "اللّهُـمَّ عافِـني في بَدَنـي ، اللّهُـمَّ عافِـني في سَمْـعي ، اللّهُـمَّ عافِـني في بَصَـري ، لا إلهَ إلاّ أَنْـتَ اللّهُـمَّ إِنّـي أَعـوذُ بِكَ مِنَ الْكُـفر ، وَالفَـقْر ، وَأَعـوذُ بِكَ مِنْ عَذابِ القَـبْر ، لا إلهَ إلاّ أَنْـتَ",
                    source: "رواه أبو داود",
                    count: 3
                },
                {
                    text: "اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في الدُّنْـيا وَالآخِـرَة ، اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في ديني وَدُنْـيايَ وَأهْـلي وَمالـي ، اللّهُـمَّ اسْتُـرْ عـوْراتي وَآمِـنْ رَوْعاتـي ، اللّهُـمَّ احْفَظْـني مِن بَـينِ يَدَيَّ وَمِن خَلْفـي وَعَن يَمـيني وَعَن شِمـالي ، وَمِن فَوْقـي ، وَأَعـوذُ بِعَظَمَـتِكَ أَن أُغْـتالَ مِن تَحْتـي",
                    source: "رواه أبو داود",
                    count: 1
                },
                {
                    text: "يَا حَيُّ يَا قيُّومُ بِرَحْمَتِكَ أسْتَغِيثُ أصْلِحْ لِي شَأنِي كُلَّهُ وَلاَ تَكِلْنِي إلَى نَفْسِي طَـرْفَةَ عَيْنٍ",
                    source: "رواه الحاكم",
                    count: 1
                },
                {
                    text: "اصبحنا واصبح المُـلكُ للهِ رَبِّ العـالَمـين ، اللّهُـمَّ إِنِّـي أسْـأَلُـكَ خَـيْرَ هذا اليوم ، فَـتْحَهُ ، وَنَصْـرَه ، وَنـورَهُ وَبَـرَكَتَـهُ ، وَهُـداهُ ، وَأَعـوذُ بِـكَ مِـنْ شَـرِّ ما فـيهِ وَشَـرِّ ما بَعْـدَه",
                    source: "رواه أبو داود",
                    count: 1
                },
                {
                    text: "اللّهُـمَّ عالِـمَ الغَـيْبِ وَالشّـهادَةِ فاطِـرَ السّماواتِ وَالأرْضِ رَبَّ كـلِّ شَـيءٍ وَمَليـكَه ، أَشْهَـدُ أَنْ لا إِلـهَ إِلاّ أَنْت ، أَعـوذُ بِكَ مِن شَـرِّ نَفْسـي وَمِن شَـرِّ الشَّيْـطانِ وَشِرْكِهِ ، وَأَنْ أَقْتَـرِفَ عَلـى نَفْسـي سوءاً أَوْ أَجُـرَّهُ إِلـى مُسْـلِم",
                    source: "رواه أبو داود والترمذي",
                    count: 1
                },
                {
                    text: "أَعـوذُ بِكَلِمـاتِ اللّهِ التّـامّـاتِ مِنْ شَـرِّ ما خَلَـق",
                    source: "رواه مسلم",
                    count: 3
                },
                {
                    text: "اللَّهُمَّ صَلِّ وَسَلِّمْ وَبَارِكْ على نَبِيِّنَا مُحمَّد",
                    source: "من صلى على حين يصبح وحين يمسى ادركته شفاعتى يوم القيامة",
                    count: 10
                },
                {
                    text: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ الْهَمِّ وَالْحَزَنِ، وَأَعُوذُ بِكَ مِنْ الْعَجْزِ وَالْكَسَلِ، وَأَعُوذُ بِكَ مِنْ الْجُبْنِ وَالْبُخْلِ، وَأَعُوذُ بِكَ مِنْ غَلَبَةِ الدَّيْنِ، وَقَهْرِ الرِّجَالِ",
                    source: "رواه أبو داود",
                    count: 3
                },
                {
                    text: "اللَّهُمَّ إِنِّي أَسْأَلُكَ عِلْمًا نَافِعًا، وَرِزْقًا طَيِّبًا، وَعَمَلًا مُتَقَبَّلًا",
                    source: "رواه ابن ماجه",
                    count: 1
                },
                {
                    text: "أستغفر الله وأتوب إليه",
                    source: "رواه البخاري",
                    count: 100
                },
                {
                    text: "لا إله إلا الله وحده لا شريك له له الملك وله الحمد وهو على كل شيء قدير",
                    source: "رواه البخاري ومسلم",
                    count: 100
                },
                {
                    text: "سبحان الله وبحمده",
                    source: "رواه مسلم",
                    count: 100
                }
            ],
            evening: [
                {
                    text: "أَعُوذُ بِاللهِ مِنْ الشَّيْطَانِ الرَّجِيمِ\nاللّهُ لاَ إِلَـهَ إِلاَّ هُوَ الْحَيُّ الْقَيُّومُ لاَ تَأْخُذُهُ سِنَةٌ وَلاَ نَوْمٌ لَّهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الأَرْضِ مَن ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلاَّ بِإِذْنِهِ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ وَلاَ يُحِيطُونَ بِشَيْءٍ مِّنْ عِلْمِهِ إِلاَّ بِمَا شَاء وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالأَرْضَ وَلاَ يَؤُودُهُ حِفْظُهُمَا وَهُوَ الْعَلِيُّ الْعَظِيمُ",
                    source: "آية الكرسي - البقرة 255. من قالها حين يمسى أجير من الجن حتى يصبح",
                    count: 1
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ هُوَ ٱللَّهُ أَحَدٌ، ٱللَّهُ ٱلصَّمَدُ، لَمْ يَلِدْ وَلَمْ يُولَدْ، وَلَمْ يَكُن لَّهُۥ كُفُوًا أَحَدٌۢ",
                    source: "من قالها حين يصبح وحين يمسى كفته من كل شىء",
                    count: 3
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ أَعُوذُ بِرَبِّ ٱلْفَلَقِ، مِن شَرِّ مَا خَلَقَ، وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ، وَمِن شَرِّ ٱلنَّفَّٰثَٰتِ فِى ٱلْعُقَدِ، وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ",
                    source: "سورة الفلق",
                    count: 3
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ أَعُوذُ بِرَبِّ ٱلنَّاسِ، مَلِكِ ٱلنَّاسِ، إِلَٰهِ ٱلنَّاسِ، مِن شَرِّ ٱلْوَسْوَاسِ ٱلْخَنَّاسِ، ٱلَّذِى يُوَسْوِسُ فِى صُدُورِ ٱلنَّاسِ، مِنَ ٱلْجِنَّةِ وَٱلنَّاسِ",
                    source: "سورة الناس",
                    count: 3
                },
                {
                    text: "أمسينا وأمسى المُـلْكُ لله وَالحَمدُ لله ، لا إلهَ إلاّ اللّهُ وَحدَهُ لا شَريكَ لهُ، لهُ المُـلكُ ولهُ الحَمْـد، وهُوَ على كلّ شَيءٍ قدير ، رَبِّ أسْـأَلُـكَ خَـيرَ ما في هـذه الليلة وَخَـيرَ ما بَعْـدَها ، وَأَعـوذُ بِكَ مِنْ شَـرِّ ما في هذه الليلة وَشَرِّ ما بَعْـدَها، رَبِّ أَعـوذُبِكَ مِنَ الْكَسَـلِ وَسـوءِ الْكِـبَر ، رَبِّ أَعـوذُ بِكَ مِنْ عَـذابٍ في النّـارِ وَعَـذابٍ في القَـبْر",
                    source: "رواه مسلم",
                    count: 1
                },
                {
                    text: "اللّهـمَّ أَنْتَ رَبِّـي لا إلهَ إلاّ أَنْتَ ، خَلَقْتَنـي وَأَنا عَبْـدُك ، وَأَنا عَلـى عَهْـدِكَ وَوَعْـدِكَ ما اسْتَـطَعْـت ، أَعـوذُبِكَ مِنْ شَـرِّ ما صَنَـعْت ، أَبـوءُ لَـكَ بِنِعْـمَتِـكَ عَلَـيَّ وَأَبـوءُ بِذَنْـبي فَاغْفـِرْ لي فَإِنَّـهُ لا يَغْـفِرُ الذُّنـوبَ إِلاّ أَنْتَ",
                    source: "من قالها موقنا بها حين يمسى ومات من ليلته دخل الجنة وكذلك حين يصبح",
                    count: 1
                },
                {
                    text: "رَضيـتُ بِاللهِ رَبَّـاً وَبِالإسْلامِ ديـناً وَبِمُحَـمَّدٍ صلى الله عليه وسلم نَبِيّـاً",
                    source: "من قالها حين يصبح وحين يمسى كان حقا على الله أن يرضيه يوم القيامة",
                    count: 3
                },
                {
                    text: "اللّهُـمَّ إِنِّـي أمسيت أُشْـهِدُك ، وَأُشْـهِدُ حَمَلَـةَ عَـرْشِـك ، وَمَلَائِكَتَكَ ، وَجَمـيعَ خَلْـقِك ، أَنَّـكَ أَنْـتَ اللهُ لا إلهَ إلاّ أَنْـتَ وَحْـدَكَ لا شَريكَ لَـك ، وَأَنَّ ُ مُحَمّـداً عَبْـدُكَ وَرَسـولُـك",
                    source: "من قالها أعتقه الله من النار",
                    count: 4
                },
                {
                    text: "اللّهُـمَّ ما أمسى بي مِـنْ نِعْـمَةٍ أَو بِأَحَـدٍ مِـنْ خَلْـقِك ، فَمِـنْكَ وَحْـدَكَ لا شريكَ لَـك ، فَلَـكَ الْحَمْـدُ وَلَـكَ الشُّكْـر",
                    source: "من قالها حين يمسى أدى شكر يومه",
                    count: 1
                },
                {
                    text: "حَسْبِـيَ اللّهُ لا إلهَ إلاّ هُوَ عَلَـيهِ تَوَكَّـلتُ وَهُوَ رَبُّ العَرْشِ العَظـيم",
                    source: "من قالها كفاه الله ما أهمه من أمر الدنيا والآخرة",
                    count: 7
                },
                {
                    text: "بِسـمِ اللهِ الذي لا يَضُـرُّ مَعَ اسمِـهِ شَيءٌ في الأرْضِ وَلا في السّمـاءِ وَهـوَ السّمـيعُ العَلـيم",
                    source: "لم يضره من الله شيء",
                    count: 3
                },
                {
                    text: "اللّهُـمَّ بِكَ أمسينا وَبِكَ أصبحنا ، وَبِكَ نَحْـيا وَبِكَ نَمُـوتُ وَإِلَـيْكَ المصير",
                    source: "رواه الترمذي",
                    count: 1
                },
                {
                    text: "أمسينا عَلَى فِطْرَةِ الإسْلاَمِ، وَعَلَى كَلِمَةِ الإِخْلاَصِ، وَعَلَى دِينِ نَبِيِّنَا مُحَمَّدٍ صَلَّى اللهُ عَلَيْهِ وَسَلَّمَ، وَعَلَى مِلَّةِ أَبِينَا إبْرَاهِيمَ حَنِيفاً مُسْلِماً وَمَا كَانَ مِنَ المُشْرِكِينَ",
                    source: "رواه أحمد",
                    count: 1
                },
                {
                    text: "سُبْحـانَ اللهِ وَبِحَمْـدِهِ عَدَدَ خَلْـقِه ، وَرِضـا نَفْسِـه ، وَزِنَـةَ عَـرْشِـه ، وَمِـدادَ كَلِمـاتِـه",
                    source: "رواه مسلم",
                    count: 3
                },
                {
                    text: "اللّهُـمَّ عافِـني في بَدَنـي ، اللّهُـمَّ عافِـني في سَمْـعي ، اللّهُـمَّ عافِـني في بَصَـري ، لا إلهَ إلاّ أَنْـتَ اللّهُـمَّ إِنّـي أَعـوذُ بِكَ مِنَ الْكُـفر ، وَالفَـقْر ، وَأَعـوذُ بِكَ مِنْ عَذابِ القَـبْر ، لا إلهَ إلاّ أَنْـتَ",
                    source: "رواه أبو داود",
                    count: 3
                },
                {
                    text: "اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في الدُّنْـيا وَالآخِـرَة ، اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في ديني وَدُنْـيايَ وَأهْـلي وَمالـي ، اللّهُـمَّ اسْتُـرْ عـوْراتي وَآمِـنْ رَوْعاتـي ، اللّهُـمَّ احْفَظْـني مِن بَـينِ يَدَيَّ وَمِن خَلْفـي وَعَن يَمـيني وَعَن شِمـالي ، وَمِن فَوْقـي ، وَأَعـوذُ بِعَظَمَـتِكَ أَن أُغْـتالَ مِن تَحْتـي",
                    source: "رواه أبو داود",
                    count: 1
                },
                {
                    text: "يَا حَيُّ يَا قيُّومُ بِرَحْمَتِكَ أسْتَغِيثُ أصْلِحْ لِي شَأنِي كُلَّهُ وَلاَ تَكِلْنِي إلَى نَفْسِي طَـرْفَةَ عَيْنٍ",
                    source: "رواه الحاكم",
                    count: 1
                },
                {
                    text: "أمسينا وأمسى المُـلكُ للهِ رَبِّ العـالَمـين ، اللّهُـمَّ إِنِّـي أسْـأَلُـكَ خَـيْرَ هذه الليلة ، فَـتْحَهُا ، وَنَصْـرَها ، وَنـورَهُا وَبَـرَكَتَـهُا ، وَهُـداهُا ، وَأَعـوذُ بِـكَ مِـنْ شَـرِّ ما فـيهِا وَشَـرِّ ما بَعْـدَها",
                    source: "رواه أبو داود",
                    count: 1
                },
                {
                    text: "اللّهُـمَّ عالِـمَ الغَـيْبِ وَالشّـهادَةِ فاطِـرَ السّماواتِ وَالأرْضِ رَبَّ كـلِّ شَـيءٍ وَمَليـكَه ، أَشْهَـدُ أَنْ لا إِلـهَ إِلاّ أَنْت ، أَعـوذُ بِكَ مِن شَـرِّ نَفْسـي وَمِن شَـرِّ الشَّيْـطانِ وَشِرْكِهِ ، وَأَنْ أَقْتَـرِفَ عَلـى نَفْسـي سوءاً أَوْ أَجُـرَّهُ إِلـى مُسْـلِم",
                    source: "رواه أبو داود والترمذي",
                    count: 1
                },
                {
                    text: "أَعـوذُ بِكَلِمـاتِ اللّهِ التّـامّـاتِ مِنْ شَـرِّ ما خَلَـق",
                    source: "رواه مسلم",
                    count: 3
                },
                {
                    text: "اللَّهُمَّ صَلِّ وَسَلِّمْ وَبَارِكْ على نَبِيِّنَا مُحمَّد",
                    source: "من صلى على حين يصبح وحين يمسى ادركته شفاعتى يوم القيامة",
                    count: 10
                },
                {
                    text: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ الْهَمِّ وَالْحَزَنِ، وَأَعُوذُ بِكَ مِنْ الْعَجْزِ وَالْكَسَلِ، وَأَعُوذُ بِكَ مِنْ الْجُبْنِ وَالْبُخْلِ، وَأَعُوذُ بِكَ مِنْ غَلَبَةِ الدَّيْنِ، وَقَهْرِ الرِّجَالِ",
                    source: "رواه أبو داود",
                    count: 3
                },
                {
                    text: "اللَّهُمَّ إِنِّي أَسْأَلُكَ عِلْمًا نَافِعًا، وَرِزْقًا طَيِّبًا، وَعَمَلًا مُتَقَبَّلًا",
                    source: "رواه ابن ماجه",
                    count: 1
                },
                {
                    text: "أستغفر الله وأتوب إليه",
                    source: "رواه البخاري",
                    count: 100
                },
                {
                    text: "لا إله إلا الله وحده لا شريك له له الملك وله الحمد وهو على كل شيء قدير",
                    source: "رواه البخاري ومسلم",
                    count: 100
                },
                {
                    text: "سبحان الله وبحمده",
                    source: "رواه مسلم",
                    count: 100
                }
            ],
            sleep: [
                {
                    text: "اللهم باسمك أموت وأحيا",
                    source: "رواه البخاري",
                    count: 1
                },
                {
                    text: "اللهم قني عذابك يوم تبعث عبادك",
                    source: "رواه الترمذي",
                    count: 3
                },
                {
                    text: "باسمك ربي وضعت جنبي، وبك أرفعه، فإن أمسكت نفسي فارحمها، وإن أرسلتها فاحفظها بما تحفظ به عبادك الصالحين",
                    source: "رواه البخاري ومسلم",
                    count: 1
                },
                {
                    text: "اللهم إنك خلقت نفسي وأنت توفاها، لك مماتها ومحياها، إن أحييتها فاحفظها، وإن أمتها فاغفر لها، اللهم إني أسألك العافية",
                    source: "رواه مسلم",
                    count: 1
                },
                {
                    text: "اللهم رب السماوات ورب الأرض ورب العرش العظيم، ربنا ورب كل شيء، فالق الحب والنوى، ومنزل التوراة والإنجيل والفرقان، أعوذ بك من شر كل شيء أنت آخذ بناصيته، اللهم أنت الأول فليس قبلك شيء، وأنت الآخر فليس بعدك شيء، وأنت الظاهر فليس فوقك شيء، وأنت الباطن فليس دونك شيء، اقض عنا الدين وأغننا من الفقر",
                    source: "رواه مسلم",
                    count: 1
                },
                {
                    text: "الحمد لله الذي أطعمنا وسقانا، وكفانا، وآوانا، فكم ممن لا كافي له ولا مؤوي",
                    source: "رواه مسلم",
                    count: 1
                },
                {
                    text: "اللهم عالم الغيب والشهادة فاطر السماوات والأرض، رب كل شيء ومليكه، أشهد أن لا إله إلا أنت، أعوذ بك من شر نفسي، ومن شر الشيطان وشركه، وأن أقترف على نفسي سوءا، أو أجره إلى مسلم",
                    source: "رواه الترمذي",
                    count: 1
                },
                {
                    text: "اللهم أسلمت نفسي إليك، وفوضت أمري إليك، وألجأت ظهري إليك، رغبة ورهبة إليك، لا ملجأ ولا منجا منك إلا إليك، اللهم آمنت بكتابك الذي أنزلت، وبنبيك الذي أرسلت",
                    source: "رواه البخاري ومسلم",
                    count: 1
                },
                {
                    text: "سبحان الله",
                    source: "رواه البخاري ومسلم",
                    count: 33
                },
                {
                    text: "الحمد لله",
                    source: "رواه البخاري ومسلم",
                    count: 33
                },
                {
                    text: "الله أكبر",
                    source: "رواه البخاري ومسلم",
                    count: 34
                },
                {
                    text: "اللهم رب السماوات السبع ورب العرش العظيم، كن لي جارا من فلان بن فلان وأحزابه من خلائقك، أن يفرط علي أحد منهم أو أن يبغي علي، عز جارك، وجل ثناؤك، ولا إله غيرك",
                    source: "رواه البخاري في الأدب المفرد",
                    count: 1
                },
                {
                    text: "أعوذ بكلمات الله التامات من شر ما خلق",
                    source: "رواه مسلم",
                    count: 3
                },
                {
                    text: "بسم الله الرحمن الرحيم\nقُلْ هُوَ ٱللَّهُ أَحَدٌ، ٱللَّهُ ٱلصَّمَدُ، لَمْ يَلِدْ وَلَمْ يُولَدْ، وَلَمْ يَكُن لَّهُۥ كُفُوًا أَحَدٌۢ",
                    source: "سورة الإخلاص",
                    count: 3
                },
                {
                    text: "بسم الله الرحمن الرحيم\nقُلْ أَعُوذُ بِرَبِّ ٱلْفَلَقِ، مِن شَرِّ مَا خَلَقَ، وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ، وَمِن شَرِّ ٱلنَّفَّٰثَٰتِ فِى ٱلْعُقَدِ، وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ",
                    source: "سورة الفلق",
                    count: 3
                }
            ]
        };

        // متغيرات عامة
        let currentMode = 'morning';
        let dhikrCounts = {};
        let reminderEnabled = false;
        let reminderInterval = null;
        let snoozeTimeout = null;

        // تهيئة العدادات
        function initializeCounts() {
            for (let mode in dhikrData) {
                if (!dhikrCounts[mode]) {
                    dhikrCounts[mode] = [];
                }
                // التأكد من أن العدادات لها نفس طول البيانات
                while (dhikrCounts[mode].length < dhikrData[mode].length) {
                    dhikrCounts[mode].push(0);
                }
            }
            loadProgress();
        }

        // حفظ التقدم
        function saveProgress() {
            localStorage.setItem('dhikrCounts', JSON.stringify(dhikrCounts));
        }

        // تحميل التقدم
        function loadProgress() {
            const saved = localStorage.getItem('dhikrCounts');
            if (saved) {
                try {
                    const loadedCounts = JSON.parse(saved);
                    // دمج البيانات المحفوظة مع البيانات الحالية
                    for (let mode in dhikrData) {
                        if (loadedCounts[mode] && Array.isArray(loadedCounts[mode])) {
                            dhikrCounts[mode] = loadedCounts[mode];
                            // التأكد من أن العدادات لها نفس طول البيانات
                            while (dhikrCounts[mode].length < dhikrData[mode].length) {
                                dhikrCounts[mode].push(0);
                            }
                        }
                    }
                } catch (e) {
                    console.log('Error loading progress:', e);
                }
            }
        }

        // تحديث شريط التقدم
        function updateProgress() {
            const data = dhikrData[currentMode];
            const counts = dhikrCounts[currentMode];
            
            if (!data || !counts) return;
            
            let completedDhikr = 0;
            let totalDhikr = data.length;
            
            // حساب عدد الأذكار المكتملة
            for (let i = 0; i < data.length; i++) {
                const currentCount = counts[i] || 0;
                if (currentCount >= data[i].count) {
                    completedDhikr++;
                }
            }
            
            const percentage = totalDhikr > 0 ? Math.round((completedDhikr / totalDhikr) * 100) : 0;
            
            document.getElementById('progress-text').textContent = `${completedDhikr}/${totalDhikr} (${percentage}%)`;
            document.getElementById('progress-fill').style.width = `${percentage}%`;
            
            // إظهار زر إعادة الكل إذا تم إكمال بعض الأذكار
            const resetBtn = document.getElementById('reset-all-btn');
            if (completedDhikr > 0) {
                resetBtn.style.display = 'block';
            } else {
                resetBtn.style.display = 'none';
            }
        }

        // عرض الأذكار
        function renderDhikr(mode) {
            const container = document.getElementById(`${mode}-dhikr`);
            const data = dhikrData[mode];
            const counts = dhikrCounts[mode];
            
            if (!container || !data || !counts) return;
            
            container.innerHTML = '';
            
            data.forEach((dhikr, index) => {
                const currentCount = counts[index] || 0;
                const dhikrElement = document.createElement('div');
                dhikrElement.className = `dhikr-item ${currentCount >= dhikr.count ? 'completed' : ''}`;
                
                dhikrElement.innerHTML = `
                    <div class="dhikr-text">${dhikr.text.replace(/\n/g, '<br>')}</div>
                    <div class="dhikr-source">${dhikr.source}</div>
                    <div class="dhikr-controls">
                        <button class="count-btn">${currentCount}/${dhikr.count}</button>
                        <button class="action-btn" onclick="incrementDhikr('${mode}', ${index})">🤲 تسبيح</button>
                        <button class="reset-btn" onclick="resetDhikr('${mode}', ${index})">🔄 إعادة</button>
                    </div>
                `;
                
                container.appendChild(dhikrElement);
            });
        }

        // زيادة العداد
        function incrementDhikr(mode, index) {
            if (!dhikrCounts[mode]) dhikrCounts[mode] = [];
            if (!dhikrCounts[mode][index]) dhikrCounts[mode][index] = 0;
            
            const maxCount = dhikrData[mode][index].count;
            if (dhikrCounts[mode][index] < maxCount) {
                dhikrCounts[mode][index]++;
                saveProgress();
                renderDhikr(mode);
                updateProgress();
                
                // تشغيل صوت أو اهتزاز عند الإكمال
                if (dhikrCounts[mode][index] === maxCount) {
                    playCompletionFeedback();
                }
            }
        }

        // إعادة تعيين ذكر واحد
        function resetDhikr(mode, index) {
            if (!dhikrCounts[mode]) dhikrCounts[mode] = [];
            dhikrCounts[mode][index] = 0;
            saveProgress();
            renderDhikr(mode);
            updateProgress();
        }

        // إعادة تعيين جميع الأذكار
        function resetAllDhikr() {
            dhikrCounts[currentMode] = dhikrData[currentMode].map(() => 0);
            saveProgress();
            renderDhikr(currentMode);
            updateProgress();
        }

        // تغيير الوضع
        function showDhikr(mode) {
            // إخفاء جميع الحاويات
            document.querySelectorAll('.dhikr-container').forEach(container => {
                container.classList.remove('active');
            });
            
            // إظهار الحاوية المطلوبة
            document.getElementById(`${mode}-dhikr`).classList.add('active');
            
            // تحديث الأزرار
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // العثور على الزر الصحيح وتفعيله
            const buttons = document.querySelectorAll('.nav-btn');
            const modeIndex = mode === 'morning' ? 0 : mode === 'evening' ? 1 : 2;
            if (buttons[modeIndex]) {
                buttons[modeIndex].classList.add('active');
            }
            
            // تحديث العنوان والخلفية
            currentMode = mode;
            const titles = {
                morning: 'أذكار الصباح',
                evening: 'أذكار المساء',
                sleep: 'أذكار النوم'
            };
            
            document.getElementById('page-title').textContent = titles[mode];
            document.body.className = mode;
            
            updateProgress();
        }

        // نظام التذكير المحسن
        function toggleReminder() {
            reminderEnabled = !reminderEnabled;
            const btn = document.getElementById('reminder-btn');
            const settings = document.getElementById('reminder-settings');
            const options = document.getElementById('reminder-options');
            const status = document.getElementById('reminder-status');
            
            if (reminderEnabled) {
                btn.textContent = '🔕 إيقاف التذكير';
                btn.classList.add('active');
                settings.style.display = 'flex';
                options.style.display = 'flex';
                status.textContent = 'التذكير مفعل - يعمل على جميع الأجهزة بدون إشعارات تقليدية';
                
                // حفظ حالة التذكير
                localStorage.setItem('reminderEnabled', 'true');
                localStorage.setItem('morningTime', document.getElementById('morning-time').value);
                localStorage.setItem('eveningTime', document.getElementById('evening-time').value);
                
                startReminderSystem();
                
                // إشعار فوري للتأكيد
                showInstantNotification('تم تفعيل التذكير بنجاح! يعمل بالصوت والاهتزاز والتنبيه المرئي', '✅');
                
            } else {
                btn.textContent = '🔔 تفعيل التذكير';
                btn.classList.remove('active');
                settings.style.display = 'none';
                options.style.display = 'none';
                status.textContent = 'مصمم خصيصاً للعمل على جميع الأجهزة';
                
                localStorage.setItem('reminderEnabled', 'false');
                stopReminderSystem();
            }
        }

        // بدء نظام التذكير
        function startReminderSystem() {
            if (reminderInterval) {
                clearInterval(reminderInterval);
            }
            
            // فحص كل دقيقة
            reminderInterval = setInterval(checkReminderTime, 60000);
            
            // فحص فوري
            checkReminderTime();
        }

        // إيقاف نظام التذكير
        function stopReminderSystem() {
            if (reminderInterval) {
                clearInterval(reminderInterval);
                reminderInterval = null;
            }
            if (snoozeTimeout) {
                clearTimeout(snoozeTimeout);
                snoozeTimeout = null;
            }
        }

        // فحص وقت التذكير
        function checkReminderTime() {
            if (!reminderEnabled) return;
            
            const now = new Date();
            const currentTime = now.getHours().toString().padStart(2, '0') + ':' + 
                              now.getMinutes().toString().padStart(2, '0');
            
            const morningTime = document.getElementById('morning-time').value;
            const eveningTime = document.getElementById('evening-time').value;
            
            if (currentTime === morningTime) {
                showReminder('morning', '🌅 وقت أذكار الصباح', 'حان وقت أذكار الصباح. بارك الله في يومك!');
            } else if (currentTime === eveningTime) {
                showReminder('evening', '🌙 وقت أذكار المساء', 'حان وقت أذكار المساء. تقبل الله منك!');
            }
        }

        // عرض التذكير
        function showReminder(mode, title, message) {
            const alertElement = document.getElementById('reminderAlert');
            const overlay = document.getElementById('overlay');
            const alertTitle = document.getElementById('alertTitle');
            const alertMessage = document.getElementById('alertMessage');
            
            alertTitle.textContent = title;
            alertMessage.textContent = message;
            
            overlay.classList.add('show');
            alertElement.classList.add('show');
            
            // تشغيل التنبيهات المختلفة
            playReminderFeedback();
            
            // تغيير إلى الوضع المناسب
            if (mode === 'morning') {
                showDhikr('morning');
            } else if (mode === 'evening') {
                showDhikr('evening');
            }
        }

        // إغلاق التنبيه
        function dismissAlert() {
            document.getElementById('overlay').classList.remove('show');
            document.getElementById('reminderAlert').classList.remove('show');
        }

        // تأجيل التنبيه
        function snoozeAlert() {
            dismissAlert();
            
            // تأجيل لمدة 5 دقائق
            snoozeTimeout = setTimeout(() => {
                const alertTitle = document.getElementById('alertTitle').textContent;
                const alertMessage = document.getElementById('alertMessage').textContent;
                showReminder(currentMode, alertTitle, alertMessage);
            }, 5 * 60 * 1000);
            
            showInstantNotification('تم تأجيل التذكير لمدة 5 دقائق', '⏰');
        }

        // تشغيل تنبيه التذكير
        function playReminderFeedback() {
            const soundEnabled = document.getElementById('sound-enabled').checked;
            const vibrationEnabled = document.getElementById('vibration-enabled').checked;
            const visualEnabled = document.getElementById('visual-enabled').checked;
            
            if (soundEnabled) {
                playReminderSound();
            }
            
            if (vibrationEnabled) {
                triggerVibration([200, 100, 200, 100, 200]);
            }
            
            if (visualEnabled) {
                triggerVisualAlert();
            }
        }

        // تشغيل تنبيه الإكمال
        function playCompletionFeedback() {
            const soundEnabled = document.getElementById('sound-enabled').checked;
            const vibrationEnabled = document.getElementById('vibration-enabled').checked;
            
            if (soundEnabled) {
                playCompletionSound();
            }
            
            if (vibrationEnabled) {
                triggerVibration([100]);
            }
        }

        // تشغيل صوت التذكير
        function playReminderSound() {
            try {
                // إنشاء صوت تذكير باستخدام Web Audio API
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // نغمة تذكير لطيفة
                oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.2); // E5
                oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.4); // G5
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.8);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.8);
            } catch (e) {
                console.log('Web Audio API not supported');
            }
        }

        // تشغيل صوت الإكمال
        function playCompletionSound() {
            try {
                // إنشاء صوت قصير للإكمال
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.2);
            } catch (e) {
                console.log('Web Audio API not supported');
            }
        }

        // تشغيل الاهتزاز
        function triggerVibration(pattern) {
            if ('vibrate' in navigator) {
                navigator.vibrate(pattern);
            }
        }

        // تشغيل التنبيه المرئي
        function triggerVisualAlert() {
            const originalTitle = document.title;
            let flashCount = 0;
            
            const flashInterval = setInterval(() => {
                document.title = flashCount % 2 === 0 ? '🔔 تذكير الأذكار!' : originalTitle;
                flashCount++;
                
                if (flashCount >= 10) {
                    clearInterval(flashInterval);
                    document.title = originalTitle;
                }
            }, 500);
            
            // تأثير وميض للصفحة
            document.body.style.animation = 'pulse 0.5s ease-in-out 3';
            setTimeout(() => {
                document.body.style.animation = '';
            }, 1500);
        }

        // إشعار فوري
        function showInstantNotification(message, icon = '📱') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #27ae60, #2ecc71);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                z-index: 10000;
                font-size: 1rem;
                max-width: 300px;
                animation: slideIn 0.3s ease-out;
            `;
            
            notification.innerHTML = `${icon} ${message}`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // تحميل الإعدادات المحفوظة
        function loadSettings() {
            const savedReminderState = localStorage.getItem('reminderEnabled');
            const savedMorningTime = localStorage.getItem('morningTime');
            const savedEveningTime = localStorage.getItem('eveningTime');
            
            if (savedMorningTime) {
                document.getElementById('morning-time').value = savedMorningTime;
            }
            
            if (savedEveningTime) {
                document.getElementById('evening-time').value = savedEveningTime;
            }
            
            if (savedReminderState === 'true') {
                setTimeout(() => {
                    toggleReminder();
                }, 100);
            }
        }

        // تهيئة التطبيق
        document.addEventListener('DOMContentLoaded', function() {
            console.log('تهيئة التطبيق...');
            
            initializeCounts();
            
            // عرض الأذكار لجميع الأوضاع
            renderDhikr('morning');
            renderDhikr('evening');
            renderDhikr('sleep');
            
            updateProgress();
            loadSettings();
            
            // حفظ الإعدادات عند التغيير
            document.getElementById('morning-time').addEventListener('change', function() {
                if (reminderEnabled) {
                    localStorage.setItem('morningTime', this.value);
                }
            });
            
            document.getElementById('evening-time').addEventListener('change', function() {
                if (reminderEnabled) {
                    localStorage.setItem('eveningTime', this.value);
                }
            });
            
            console.log('تم تهيئة التطبيق بنجاح');
        });

        // إغلاق التنبيه عند النقر على الخلفية
        document.getElementById('overlay').addEventListener('click', dismissAlert);
    </script>
</body>
</html>

